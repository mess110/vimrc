#!/usr/bin/env bash

lock() {
  i3lock --color=17181b
}

toggleautolock() {
  ps cax | grep xautolock > /dev/null
  if [ $? -eq 0 ]
  then
    pkill -9 xautolock
  else
    i3-msg 'exec xautolock -time 15 -locker "i3lock --color=17181b" -detectsleep'
  fi
}

showautolock() {
  ps cax | grep xautolock > /dev/null
  if [ $? -eq 0 ]
  then
    echo ''
  else
    echo ' ðŸ”“'
  fi
}

togglelayout() {
  layout=`setxkbmap -query | grep layout | awk '{print $2}'`
  if [ "$layout" = "us" ]
  then
    setxkbmap ro
  else
    setxkbmap us
  fi
}

case "$1" in
  lock)
    lock
    ;;
  toggleautolock)
    toggleautolock
    ;;
  showautolock)
    showautolock
    ;;
  togglelayout)
    togglelayout
    ;;
  logout)
    i3-msg exit
    ;;
  suspend)
    lock && systemctl suspend
    ;;
  hibernate)
    lock && systemctl hibernate
    ;;
  reboot)
    systemctl reboot
    ;;
  shutdown)
    systemctl poweroff
    ;;
  *)
    echo "Usage: $0 {lock|toggleautolock|showautolock|togglelayout|logout|suspend|hibernate|reboot|shutdown}"
    exit 2
esac

exit 0
