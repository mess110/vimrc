#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
import subprocess
import re


if len(sys.argv) < 2:
    sys.argv.append('icon')

valid_formats = ['icon', 'raw', 'percent']
output_format = sys.argv[1] if sys.argv[1] in valid_formats else 'icon'

try:
    cmd = 'amixer -D pulse sget Master'
    process = subprocess.Popen(cmd.split(' '), stdout=subprocess.PIPE)
    output, error = process.communicate()
    volume_full = output.split()[-3]
    result = int(re.sub('[^0-9]','', volume_full))

    max_volume = 65035

    if output_format == 'icon':
        if result > max_volume / 3 * 2:
            print('ðŸ”Š')
        elif result > max_volume / 3:
            print('ðŸ”‰')
        elif result > 0:
            print('ðŸ”ˆ')
        else:
            print('ðŸ”‡')
    elif output_format == 'raw':
        print(result)
    else:
        print('%s%%' % str((100 * result) / max_volume))
except IndexError as e:
    pass
